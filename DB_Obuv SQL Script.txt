-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.article
(
    id bigserial NOT NULL,
    order_number_fk integer,
    order_article_fk character varying(255) COLLATE pg_catalog."default",
    kolvo integer,
    CONSTRAINT article_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.category
(
    id bigint NOT NULL DEFAULT nextval('category1_id_seq'::regclass),
    category_pk character varying(155) COLLATE pg_catalog."default",
    CONSTRAINT category_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.name_tovar
(
    id bigint NOT NULL DEFAULT nextval('name_tovar1_id_seq'::regclass),
    "name_tovar_pk " character varying(155) COLLATE pg_catalog."default",
    CONSTRAINT name_tovar_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.order_status
(
    id bigserial NOT NULL,
    status_fk character varying(155) COLLATE pg_catalog."default",
    CONSTRAINT order_status_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.orders
(
    order_id bigint NOT NULL DEFAULT nextval('orders_id_seq'::regclass),
    order_date date,
    dostav_date date,
    name integer,
    pvz integer,
    kod_poluch integer,
    order_status integer,
    CONSTRAINT orders_pkey PRIMARY KEY (order_id)
);

CREATE TABLE IF NOT EXISTS public.postavshik
(
    id bigint NOT NULL DEFAULT nextval('postavshik1_id_seq'::regclass),
    postavshik_pk character varying(155) COLLATE pg_catalog."default",
    CONSTRAINT postavshik_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.proizvod
(
    id bigint NOT NULL DEFAULT nextval('proizvod1_id_seq'::regclass),
    proizvod_pk character varying(155) COLLATE pg_catalog."default",
    CONSTRAINT proizvod_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.pvz
(
    id bigserial NOT NULL,
    pvz_fk character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT pvz_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.tovar
(
    id_article character varying(155) COLLATE pg_catalog."default" NOT NULL,
    name_tovar_fk integer,
    edinic_izm character varying(15) COLLATE pg_catalog."default",
    sale bigint,
    postavshik_fl integer,
    proizvod_fk integer,
    category_fk integer,
    discount integer,
    quantity integer,
    opisanie character varying(255) COLLATE pg_catalog."default",
    image character varying(155) COLLATE pg_catalog."default",
    CONSTRAINT tovar_pkey PRIMARY KEY (id_article)
);

CREATE TABLE IF NOT EXISTS public.user_role
(
    id bigserial NOT NULL,
    role character varying(155) COLLATE pg_catalog."default",
    CONSTRAINT user_role_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.users
(
    id bigserial NOT NULL,
    role integer,
    name character varying(255) COLLATE pg_catalog."default",
    login character varying(255) COLLATE pg_catalog."default",
    password character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT users_pkey PRIMARY KEY (id)
);

ALTER TABLE IF EXISTS public.article
    ADD CONSTRAINT article_order_article_fk_fkey FOREIGN KEY (order_article_fk)
    REFERENCES public.tovar (id_article) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE CASCADE
    NOT VALID;


ALTER TABLE IF EXISTS public.article
    ADD CONSTRAINT orders_order_id_fk FOREIGN KEY (order_number_fk)
    REFERENCES public.orders (order_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT order_status_fk FOREIGN KEY (order_status)
    REFERENCES public.order_status (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT orders_pvz_fk FOREIGN KEY (pvz)
    REFERENCES public.pvz (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.orders
    ADD CONSTRAINT orders_users_fk FOREIGN KEY (name)
    REFERENCES public.users (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.tovar
    ADD CONSTRAINT tovar_category_fk_fkey FOREIGN KEY (category_fk)
    REFERENCES public.category (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.tovar
    ADD CONSTRAINT tovar_name_tovar_fk_fkey FOREIGN KEY (name_tovar_fk)
    REFERENCES public.name_tovar (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.tovar
    ADD CONSTRAINT tovar_postavshik_fl_fkey FOREIGN KEY (postavshik_fl)
    REFERENCES public.postavshik (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.tovar
    ADD CONSTRAINT tovar_proizvod_fk_fkey FOREIGN KEY (proizvod_fk)
    REFERENCES public.proizvod (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users
    ADD CONSTRAINT users_user_role_fk FOREIGN KEY (role)
    REFERENCES public.user_role (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;